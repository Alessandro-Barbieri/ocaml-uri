<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Uri (uri.Uri)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/></head><body><header><nav><a href="../index.html">Up</a> â€“ package <a href="../index.html">uri</a></nav><h1>Module Uri</h1><p>Uniform Resource Identifier handling that is RFC3986-compliant.</p></header><dl><dt><a href="#type-t" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>t</code><code></code><code></code></div></dt><dd><p>A single URI that is a compact sequence of characters that identifies an abstract or physical resource.</p></dd><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include </span><span class="keyword">sig</span> ... <span class="keyword">end</span></code></span></summary><dl><dt><a href="#val-t_of_sexp" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>t_of_sexp : Sexplib.Sexp.t <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div></dt><dt><a href="#val-sexp_of_t" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>sexp_of_t : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> Sexplib.Sexp.t</code></div></dt></dl></details></div></div><dt><a href="#type-component" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>component</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-component.Scheme" class="anchored"><td class="def constructor"><a href="#type-component.Scheme" class="anchor"></a><code><span class="keyword">| </span></code><code>`Scheme</code></td></tr><tr id="type-component.Authority" class="anchored"><td class="def constructor"><a href="#type-component.Authority" class="anchor"></a><code><span class="keyword">| </span></code><code>`Authority</code></td></tr><tr id="type-component.Userinfo" class="anchored"><td class="def constructor"><a href="#type-component.Userinfo" class="anchor"></a><code><span class="keyword">| </span></code><code>`Userinfo</code></td></tr><tr id="type-component.Host" class="anchored"><td class="def constructor"><a href="#type-component.Host" class="anchor"></a><code><span class="keyword">| </span></code><code>`Host</code></td></tr><tr id="type-component.Path" class="anchored"><td class="def constructor"><a href="#type-component.Path" class="anchor"></a><code><span class="keyword">| </span></code><code>`Path</code></td></tr><tr id="type-component.Query" class="anchored"><td class="def constructor"><a href="#type-component.Query" class="anchor"></a><code><span class="keyword">| </span></code><code>`Query</code></td></tr><tr id="type-component.Query_key" class="anchored"><td class="def constructor"><a href="#type-component.Query_key" class="anchor"></a><code><span class="keyword">| </span></code><code>`Query_key</code></td></tr><tr id="type-component.Query_value" class="anchored"><td class="def constructor"><a href="#type-component.Query_value" class="anchor"></a><code><span class="keyword">| </span></code><code>`Query_value</code></td></tr><tr id="type-component.Fragment" class="anchored"><td class="def constructor"><a href="#type-component.Fragment" class="anchor"></a><code><span class="keyword">| </span></code><code>`Fragment</code></td></tr></table><code> ]</code><code></code></div></dt><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include </span><span class="keyword">sig</span> ... <span class="keyword">end</span></code></span></summary><dl><dt><a href="#val-component_of_sexp" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>component_of_sexp : Sexplib.Sexp.t <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-component">component</a></code></div></dt><dt><a href="#val-__component_of_sexp__" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>__component_of_sexp__ : Sexplib.Sexp.t <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-component">component</a></code></div></dt><dt><a href="#val-sexp_of_component" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>sexp_of_component : <a href="index.html#type-component">component</a> <span class="keyword">&#8209;&gt;</span> Sexplib.Sexp.t</code></div></dt></dl></details></div></div></dl><h3>Core functionality</h3><dl><dt><a href="#val-empty" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>empty : <a href="index.html#type-t">t</a></code></div></dt><dd><p>The empty (zero length) URI reference. Useful for constructing URIs piece-by-piece.</p></dd><dt><a href="#val-compare" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>compare : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> int</code></div></dt><dd><p>Comparator ordering by host, scheme, port, userinfo, path, query, and finally fragment. Designed to produce a reasonable sort order.</p></dd><dt><a href="#val-equal" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>equal : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> bool</code></div></dt><dd><p><code>equal a b</code> is <code>compare a b = 0</code>.</p></dd><dt><a href="#val-pct_encode" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>pct_encode : ?&#8288;scheme:string <span class="keyword">&#8209;&gt;</span> ?&#8288;component:<a href="index.html#type-component">component</a> <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> string</code></div></dt><dd><p>Percent-encode a string. The <code>scheme</code> argument defaults to 'http' and the <code>component</code> argument defaults to `Path</p></dd><dt><a href="#val-pct_decode" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>pct_decode : string <span class="keyword">&#8209;&gt;</span> string</code></div></dt><dd><p>Percent-decode a percent-encoded string</p></dd><dt><a href="#val-of_string" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>of_string : string <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div></dt><dd><p>Parse a URI string literal into a URI structure. A bare string will be interpreted as a path; a string prefixed with `//` will be interpreted as a host.</p></dd><dt><a href="#val-to_string" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>to_string : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string</code></div></dt><dd><p>Convert a URI structure into a percent-encoded URI string</p></dd><dt><a href="#val-resolve" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>resolve : string <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div></dt><dd><p>Resolve a URI against a default scheme and base URI</p></dd><dt><a href="#val-canonicalize" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>canonicalize : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div></dt><dd><p>Canonicalize a URI according to Sec 6.2.3 &quot;Scheme-Based Normalization&quot;. This transform is more aggressive than the standard URI-generic normalization automatically done. In particular, HTTP(S) URIs with empty path components will have their path components set to &quot;/&quot;. Some applications like web servers may rely on the distinction between a path-less and a root-path URI to distinguish request URIs (e.g. OPTIONS * vs OPTIONS /).</p><dl><dt>see <a href="https://tools.ietf.org/html/rfc3986#section-6.2.3">https://tools.ietf.org/html/rfc3986#section-6.2.3</a></dt><dd><p>RFC 3986.6.2.3</p></dd></dl></dd><dt><a href="#val-make" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>make : ?&#8288;scheme:string <span class="keyword">&#8209;&gt;</span> ?&#8288;userinfo:string <span class="keyword">&#8209;&gt;</span> ?&#8288;host:string <span class="keyword">&#8209;&gt;</span> ?&#8288;port:int <span class="keyword">&#8209;&gt;</span> ?&#8288;path:string <span class="keyword">&#8209;&gt;</span> ?&#8288;query:(string<span class="keyword"> * </span>string list) list <span class="keyword">&#8209;&gt;</span> ?&#8288;fragment:string <span class="keyword">&#8209;&gt;</span> unit <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div></dt><dd><p>Make a URI from supplied components. If userinfo or port are supplied without host, an empty host is added. If path is supplied and userinfo, host, or port is also supplied, path is made absolute but not resolved.</p></dd><dt><a href="#val-with_uri" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>with_uri : ?&#8288;scheme:string option <span class="keyword">&#8209;&gt;</span> ?&#8288;userinfo:string option <span class="keyword">&#8209;&gt;</span> ?&#8288;host:string option <span class="keyword">&#8209;&gt;</span> ?&#8288;port:int option <span class="keyword">&#8209;&gt;</span> ?&#8288;path:string option <span class="keyword">&#8209;&gt;</span> ?&#8288;query:(string<span class="keyword"> * </span>string list) list option <span class="keyword">&#8209;&gt;</span> ?&#8288;fragment:string option <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div></dt><dd><p>Functional update for a URI using the supplied components. If a component is unspecified then it will be unchanged. If a component is supplied as <code>None</code> then the component will be removed in the returned URI. If a component is supplied as <code>Some x</code> then <code>x</code> will be added if it does not exist in the source URI or replaced if it does exist.</p></dd></dl><h3>Query functions</h3><p>The query string API attempts to accommodate conventional query string representations (i.e. <code>?key0=value0&amp;key1=value1</code>) while maximally exposing any meaning in those representations. For example, it is not necessarily the case that <code>/</code> and <code>/?</code> are equivalent to a web server. In the former case, we observe a zero query string whereas in the latter case, we observe a query string with a single key, <code>&quot;&quot;</code> and a zero value. Compare this with <code>/?=</code> which has a single key and a single empty value, <code>&quot;&quot;</code>. Additionally, some query functions return lists of values for a key. These list values are extracted from a <b>single</b> key with a comma-separated value list. If a query string has multiple identical keys, you must use <a href="index.html#val-query">query</a> to retrieve the entirety of the structured query string.</p><dl><dt><a href="#val-query" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>query : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> (string<span class="keyword"> * </span>string list) list</code></div></dt><dd><p>Get a query string from a URI</p></dd><dt><a href="#val-verbatim_query" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>verbatim_query : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string option</code></div></dt><dd><p>Get a verbatim query string from a URI. If the provenance of the URI is a string and its query component has not been updated, this is the literal query string as parsed. Otherwise, this is the composition of <a href="index.html#val-query">query</a> and <a href="index.html#val-encoded_of_query">encoded_of_query</a></p></dd><dt><a href="#val-encoded_of_query" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>encoded_of_query : ?&#8288;scheme:string <span class="keyword">&#8209;&gt;</span> (string<span class="keyword"> * </span>string list) list <span class="keyword">&#8209;&gt;</span> string</code></div></dt><dd><p>Make a percent-encoded query string from percent-decoded query tuple</p></dd><dt><a href="#val-query_of_encoded" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>query_of_encoded : string <span class="keyword">&#8209;&gt;</span> (string<span class="keyword"> * </span>string list) list</code></div></dt><dd><p>Parse a percent-encoded query string into a percent-decoded query tuple</p></dd><dt><a href="#val-with_query" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>with_query : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> (string<span class="keyword"> * </span>string list) list <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div></dt><dd><p>Replace the query URI with the supplied list. Input URI is not modified</p></dd><dt><a href="#val-with_query'" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>with_query' : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> (string<span class="keyword"> * </span>string) list <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div></dt><dd><p>Replace the query URI with the supplied singleton query list. Input URI is not modified</p></dd><dt><a href="#val-get_query_param'" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>get_query_param' : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> string list option</code></div></dt><dd><p><code>get_query_param' q key</code> returns the list of values for the <code>key</code> parameter in query <code>q</code>. Note that an empty list is not the same as a <code>None</code> return value. For a query <code>foo</code>, the mapping is:</p><ul><li><code>/</code> returns None</li><li><code>/?foo</code> returns Some <code></code></li><li><code>/?foo=</code> returns <code>Some [&quot;&quot;]</code></li><li><code>/?foo=bar</code> returns <code>Some [&quot;bar&quot;]</code></li><li><code>/?foo=bar,chi</code> returns <code>Some [&quot;bar&quot;,&quot;chi&quot;]</code></li></ul><p>Query keys can be duplicated in the URI, in which case the first one is returned. If you want to resolve duplicate keys, obtain the full result set with <a href="index.html#val-query">query</a> instead.</p></dd><dt><a href="#val-get_query_param" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>get_query_param : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> string option</code></div></dt><dd><p><code>get_query_param q key</code> returns the value found for a <code>key</code> in query <code>q</code>. If there are multiple values for the key, then the first one is returned.</p></dd><dt><a href="#val-add_query_param" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>add_query_param : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> (string<span class="keyword"> * </span>string list) <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div></dt><dd><p>Add a query parameter to the input query URI. Input URI is not modified</p></dd><dt><a href="#val-add_query_param'" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>add_query_param' : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> (string<span class="keyword"> * </span>string) <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div></dt><dd><p>Add a query parameter to the input singleton query URI. Input URI is not modified</p></dd><dt><a href="#val-add_query_params" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>add_query_params : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> (string<span class="keyword"> * </span>string list) list <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div></dt><dd><p>Add a query parameter list to the input query URI. Input URI is not modified</p></dd><dt><a href="#val-add_query_params'" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>add_query_params' : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> (string<span class="keyword"> * </span>string) list <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div></dt><dd><p>Add a query singleton parameter list to the input query URI. Input URI is not modified</p></dd><dt><a href="#val-remove_query_param" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>remove_query_param : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div></dt><dd><p>Remove a query key from the input query URI. Input URI is not modified, and no error is generated if the key does not already exist in the URI.</p></dd></dl><h3>Component getters and setters</h3><dl><dt><a href="#val-path" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>path : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string</code></div></dt><dd><p>Get the encoded path component of a URI</p></dd><dt><a href="#val-path_and_query" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>path_and_query : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string</code></div></dt><dd><p>Get the encoded path and query components of a URI</p></dd><dt><a href="#val-with_path" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>with_path : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div></dt><dd><p>Replace the path URI with the supplied encoded path. If a host is present in the supplied URI, the path is made absolute but not resolved. If the path is empty, the path component is removed. Input URI is not modified</p></dd><dt><a href="#val-scheme" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>scheme : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string option</code></div></dt><dd><p>Get the scheme component of a URI</p></dd><dt><a href="#val-with_scheme" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>with_scheme : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string option <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div></dt><dd><p>Replace the scheme portion of the URI with the supplied <code>scheme</code>. Input URI is not modified</p></dd><dt><a href="#val-userinfo" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>userinfo : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string option</code></div></dt><dd><p>Get the userinfo component of a URI</p></dd><dt><a href="#val-with_userinfo" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>with_userinfo : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string option <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div></dt><dd><p>Replace the userinfo portion of the URI with the supplied <code>string option</code>. If no host is present in the supplied URI, an empty host is added. Input URI is not modified.</p></dd><dt><a href="#val-user" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>user : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string option</code></div></dt><dd><p>Get the username component of a URI</p></dd><dt><a href="#val-password" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>password : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string option</code></div></dt><dd><p>Get the password component of a URI</p></dd><dt><a href="#val-with_password" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>with_password : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string option <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div></dt><dd><p>Replace the password portion of the URI with the supplied <code>string option</code>. If no host is present in the supplied URI, an empty host is added. Input URI is not modified.</p></dd><dt><a href="#val-host" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>host : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string option</code></div></dt><dd><p>Get the host component of a URI</p></dd><dt><a href="#val-with_host" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>with_host : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string option <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div></dt><dd><p>Replace the host component of the URI. Input URI is not modified.</p></dd><dt><a href="#val-host_with_default" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>host_with_default : ?&#8288;default:string <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string</code></div></dt><dd><p>Get the host component of a URI, with a default supplied if one is not present</p></dd><dt><a href="#val-port" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>port : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> int option</code></div></dt><dd><p>Get the port component of a URI</p></dd><dt><a href="#val-with_port" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>with_port : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> int option <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div></dt><dd><p>Replace the port component of the URI with the supplied port. If no host is present in the supplied URI, an empty host is added. Input URI is not modified.</p></dd><dt><a href="#val-fragment" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>fragment : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string option</code></div></dt><dd><p>Get the fragment component of a URI</p></dd><dt><a href="#val-with_fragment" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>with_fragment : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string option <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div></dt><dd><p>Replace the fragment component of a URI with the supplied fragment. Input URI is not modified</p></dd></dl><h3>Utilities</h3><dl><dt><a href="#val-pp_hum" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>pp_hum : Format.formatter <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> unit</code></div></dt><dd><p>Human-readable output, used by the toplevel printer</p></dd></dl></body></html>